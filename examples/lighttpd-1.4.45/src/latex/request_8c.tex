\hypertarget{request_8c}{\section{request.\-c File Reference}
\label{request_8c}\index{request.\-c@{request.\-c}}
}
{\ttfamily \#include \char`\"{}first.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}request.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}keyvalue.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}log.\-h\char`\"{}}\\*
{\ttfamily \#include $<$sys/stat.\-h$>$}\\*
{\ttfamily \#include $<$limits.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$ctype.\-h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \hyperlink{request_8c_abf232d7bd4b53b83abcb5c11f3591ad5}{request\-\_\-check\-\_\-hostname} (\hyperlink{structbuffer}{buffer} $\ast$host)
\item 
int \hyperlink{request_8c_acdde7c16cc6d7a7034f6a4c1749737a8}{http\-\_\-request\-\_\-host\-\_\-normalize} (\hyperlink{structbuffer}{buffer} $\ast$b)
\item 
static int \hyperlink{request_8c_a9413105f7eb4ccaa3d99f2651516153d}{http\-\_\-request\-\_\-split\-\_\-value} (\hyperlink{structarray}{array} $\ast$vals, \hyperlink{structbuffer}{buffer} $\ast$b)
\item 
static int \hyperlink{request_8c_aecae30e3e2699b7951361588f432a419}{request\-\_\-uri\-\_\-is\-\_\-valid\-\_\-char} (unsigned char c)
\item 
int \hyperlink{request_8c_a820dceb933d8308d36e31d458f25e364}{http\-\_\-request\-\_\-parse} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
int \hyperlink{request_8c_a9133b7764d3adedef5d89a8d1f151b39}{http\-\_\-request\-\_\-header\-\_\-finished} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{request_8c_a9133b7764d3adedef5d89a8d1f151b39}{\index{request.\-c@{request.\-c}!http\-\_\-request\-\_\-header\-\_\-finished@{http\-\_\-request\-\_\-header\-\_\-finished}}
\index{http\-\_\-request\-\_\-header\-\_\-finished@{http\-\_\-request\-\_\-header\-\_\-finished}!request.c@{request.\-c}}
\subsubsection[{http\-\_\-request\-\_\-header\-\_\-finished}]{\setlength{\rightskip}{0pt plus 5cm}int http\-\_\-request\-\_\-header\-\_\-finished (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)}}\label{request_8c_a9133b7764d3adedef5d89a8d1f151b39}


References buffer\-\_\-string\-\_\-length(), C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, buffer\-::ptr, request\-::request, connection\-::request, and U\-N\-U\-S\-E\-D.

\hypertarget{request_8c_acdde7c16cc6d7a7034f6a4c1749737a8}{\index{request.\-c@{request.\-c}!http\-\_\-request\-\_\-host\-\_\-normalize@{http\-\_\-request\-\_\-host\-\_\-normalize}}
\index{http\-\_\-request\-\_\-host\-\_\-normalize@{http\-\_\-request\-\_\-host\-\_\-normalize}!request.c@{request.\-c}}
\subsubsection[{http\-\_\-request\-\_\-host\-\_\-normalize}]{\setlength{\rightskip}{0pt plus 5cm}int http\-\_\-request\-\_\-host\-\_\-normalize (
\begin{DoxyParamCaption}
\item[{{\bf buffer} $\ast$}]{b}
\end{DoxyParamCaption}
)}}\label{request_8c_acdde7c16cc6d7a7034f6a4c1749737a8}


References buffer\-\_\-append\-\_\-int(), buffer\-\_\-append\-\_\-string\-\_\-len(), buffer\-\_\-copy\-\_\-string(), buffer\-\_\-string\-\_\-length(), buffer\-\_\-string\-\_\-set\-\_\-length(), C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, light\-\_\-isdigit(), and buffer\-::ptr.



Referenced by configparser\-\_\-remoteip\-\_\-normalize\-\_\-compat(), http\-\_\-request\-\_\-parse(), and yy\-\_\-reduce().

\hypertarget{request_8c_a820dceb933d8308d36e31d458f25e364}{\index{request.\-c@{request.\-c}!http\-\_\-request\-\_\-parse@{http\-\_\-request\-\_\-parse}}
\index{http\-\_\-request\-\_\-parse@{http\-\_\-request\-\_\-parse}!request.c@{request.\-c}}
\subsubsection[{http\-\_\-request\-\_\-parse}]{\setlength{\rightskip}{0pt plus 5cm}int http\-\_\-request\-\_\-parse (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)}}\label{request_8c_a820dceb933d8308d36e31d458f25e364}
1$\ast$$<$any char=\char`\"{}\char`\"{} except=\char`\"{}\char`\"{} ctls=\char`\"{}\char`\"{} or=\char`\"{}\char`\"{} separators$>$=\char`\"{}\char`\"{}$>$ C\-T\-Ls == 0-\/31 + 127, C\-H\-A\-R = 7-\/bit ascii (0..127)

we use a evil hack to handle the line-\/folding

As \hyperlink{array_8c_a785bb3fb3022ccb15596be169a6e522a}{array\-\_\-insert\-\_\-unique()} deletes 'ds' in the case of a duplicate ds points somewhere and we get a evil crash. As a solution we keep the old \char`\"{}key\char`\"{} and get the current value from the hash and append us

References specific\-\_\-config\-::allow\-\_\-http11, array\-\_\-get\-\_\-element(), array\-\_\-get\-\_\-unused\-\_\-element(), array\-\_\-insert\-\_\-unique(), array\-\_\-reset(), buffer\-\_\-append\-\_\-string(), buffer\-\_\-caseless\-\_\-compare(), buffer\-\_\-copy\-\_\-buffer(), buffer\-\_\-copy\-\_\-string\-\_\-len(), buffer\-\_\-free(), buffer\-\_\-init(), buffer\-\_\-is\-\_\-empty(), buffer\-\_\-reset(), buffer\-\_\-string\-\_\-is\-\_\-empty(), buffer\-\_\-string\-\_\-length(), connection\-::conf, C\-O\-N\-S\-T\-\_\-\-B\-U\-F\-\_\-\-L\-E\-N, C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, request\-::content\-\_\-length, array\-::data, data\-\_\-string\-\_\-init(), connection\-::fd, get\-\_\-http\-\_\-method\-\_\-key(), connection\-::header\-\_\-len, request\-::headers, request\-::http\-\_\-content\-\_\-type, request\-::http\-\_\-host, request\-::http\-\_\-if\-\_\-modified\-\_\-since, request\-::http\-\_\-if\-\_\-none\-\_\-match, request\-::http\-\_\-method, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-G\-E\-T, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-H\-E\-A\-D, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-P\-O\-S\-T, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-U\-N\-S\-E\-T, H\-T\-T\-P\-\_\-\-P\-A\-R\-S\-E\-O\-P\-T\-\_\-\-H\-E\-A\-D\-E\-R\-\_\-\-S\-T\-R\-I\-C\-T, H\-T\-T\-P\-\_\-\-P\-A\-R\-S\-E\-O\-P\-T\-\_\-\-H\-O\-S\-T\-\_\-\-N\-O\-R\-M\-A\-L\-I\-Z\-E, H\-T\-T\-P\-\_\-\-P\-A\-R\-S\-E\-O\-P\-T\-\_\-\-H\-O\-S\-T\-\_\-\-S\-T\-R\-I\-C\-T, specific\-\_\-config\-::http\-\_\-parseopts, request\-::http\-\_\-range, http\-\_\-request\-\_\-host\-\_\-normalize(), http\-\_\-request\-\_\-split\-\_\-value(), connection\-::http\-\_\-status, request\-::http\-\_\-version, H\-T\-T\-P\-\_\-\-V\-E\-R\-S\-I\-O\-N\-\_\-1\-\_\-0, H\-T\-T\-P\-\_\-\-V\-E\-R\-S\-I\-O\-N\-\_\-1\-\_\-1, response\-::keep\-\_\-alive, connection\-::keep\-\_\-alive, log\-\_\-error\-\_\-write(), specific\-\_\-config\-::log\-\_\-request\-\_\-header, server\-\_\-config\-::log\-\_\-request\-\_\-header\-\_\-on\-\_\-error, request\-::orig\-\_\-uri, connection\-::parse\-\_\-request, buffer\-::ptr, server\-\_\-config\-::reject\-\_\-expect\-\_\-100\-\_\-with\-\_\-417, request\-::request, connection\-::request, request\-\_\-check\-\_\-hostname(), connection\-::request\-\_\-count, request\-::request\-\_\-line, request\-\_\-uri\-\_\-is\-\_\-valid\-\_\-char(), connection\-::response, server\-::split\-\_\-vals, server\-::srvconf, T\-Y\-P\-E\-\_\-\-S\-T\-R\-I\-N\-G, request\-::uri, array\-::used, and data\-\_\-string\-::value.



Referenced by connection\-\_\-state\-\_\-machine().

\hypertarget{request_8c_a9413105f7eb4ccaa3d99f2651516153d}{\index{request.\-c@{request.\-c}!http\-\_\-request\-\_\-split\-\_\-value@{http\-\_\-request\-\_\-split\-\_\-value}}
\index{http\-\_\-request\-\_\-split\-\_\-value@{http\-\_\-request\-\_\-split\-\_\-value}!request.c@{request.\-c}}
\subsubsection[{http\-\_\-request\-\_\-split\-\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}static int http\-\_\-request\-\_\-split\-\_\-value (
\begin{DoxyParamCaption}
\item[{{\bf array} $\ast$}]{vals, }
\item[{{\bf buffer} $\ast$}]{b}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{request_8c_a9413105f7eb4ccaa3d99f2651516153d}


References array\-\_\-get\-\_\-unused\-\_\-element(), array\-\_\-insert\-\_\-unique(), buffer\-\_\-copy\-\_\-string\-\_\-len(), buffer\-\_\-string\-\_\-is\-\_\-empty(), buffer\-\_\-string\-\_\-length(), current, data\-\_\-string\-\_\-init(), buffer\-::ptr, T\-Y\-P\-E\-\_\-\-S\-T\-R\-I\-N\-G, and data\-\_\-string\-::value.



Referenced by http\-\_\-request\-\_\-parse().

\hypertarget{request_8c_abf232d7bd4b53b83abcb5c11f3591ad5}{\index{request.\-c@{request.\-c}!request\-\_\-check\-\_\-hostname@{request\-\_\-check\-\_\-hostname}}
\index{request\-\_\-check\-\_\-hostname@{request\-\_\-check\-\_\-hostname}!request.c@{request.\-c}}
\subsubsection[{request\-\_\-check\-\_\-hostname}]{\setlength{\rightskip}{0pt plus 5cm}static int request\-\_\-check\-\_\-hostname (
\begin{DoxyParamCaption}
\item[{{\bf buffer} $\ast$}]{host}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{request_8c_abf232d7bd4b53b83abcb5c11f3591ad5}


References buffer\-\_\-string\-\_\-length(), buffer\-\_\-string\-\_\-set\-\_\-length(), light\-\_\-isalnum(), light\-\_\-isdigit(), light\-\_\-isxdigit(), and buffer\-::ptr.



Referenced by http\-\_\-request\-\_\-parse().

\hypertarget{request_8c_aecae30e3e2699b7951361588f432a419}{\index{request.\-c@{request.\-c}!request\-\_\-uri\-\_\-is\-\_\-valid\-\_\-char@{request\-\_\-uri\-\_\-is\-\_\-valid\-\_\-char}}
\index{request\-\_\-uri\-\_\-is\-\_\-valid\-\_\-char@{request\-\_\-uri\-\_\-is\-\_\-valid\-\_\-char}!request.c@{request.\-c}}
\subsubsection[{request\-\_\-uri\-\_\-is\-\_\-valid\-\_\-char}]{\setlength{\rightskip}{0pt plus 5cm}static int request\-\_\-uri\-\_\-is\-\_\-valid\-\_\-char (
\begin{DoxyParamCaption}
\item[{unsigned char}]{c}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{request_8c_aecae30e3e2699b7951361588f432a419}


Referenced by http\-\_\-request\-\_\-parse().

