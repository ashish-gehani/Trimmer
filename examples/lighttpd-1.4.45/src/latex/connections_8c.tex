\hypertarget{connections_8c}{\section{connections.\-c File Reference}
\label{connections_8c}\index{connections.\-c@{connections.\-c}}
}
{\ttfamily \#include \char`\"{}first.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}buffer.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}server.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}log.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}connections.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fdevent.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}configfile.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}request.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}response.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}network.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\-\_\-chunk.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stat\-\_\-cache.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}joblist.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}plugin.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}inet\-\_\-ntop\-\_\-cache.\-h\char`\"{}}\\*
{\ttfamily \#include $<$sys/stat.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include $<$errno.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$fcntl.\-h$>$}\\*
{\ttfamily \#include $<$assert.\-h$>$}\\*
{\ttfamily \#include \char`\"{}sys-\/socket.\-h\char`\"{}}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structplugin__data}{plugin\-\_\-data}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{connections_8c_a05b3586abd20197117285bc6f4e89394}{C\-L\-E\-A\-N}(x)~con-\/$>$x = \hyperlink{buffer_8h_af447519a12f8488d289adedb31c38086}{buffer\-\_\-init}();
\item 
\#define \hyperlink{connections_8c_a05b3586abd20197117285bc6f4e89394}{C\-L\-E\-A\-N}(x)~\hyperlink{buffer_8h_ad591d3747a0ec8cf335e3538b0e640b4}{buffer\-\_\-free}(con-\/$>$x);
\item 
\#define \hyperlink{connections_8c_a05b3586abd20197117285bc6f4e89394}{C\-L\-E\-A\-N}(x)~if (con-\/$>$x) \hyperlink{buffer_8h_a21c0cf8209c5e356ed4bc97e1f7eba6f}{buffer\-\_\-reset}(con-\/$>$x);
\item 
\#define \hyperlink{connections_8c_a05b3586abd20197117285bc6f4e89394}{C\-L\-E\-A\-N}(x)~if (con-\/$>$x) con-\/$>$x-\/$>$used = 0;
\item 
\#define \hyperlink{connections_8c_a05b3586abd20197117285bc6f4e89394}{C\-L\-E\-A\-N}(x)~con-\/$>$request.\-x = N\-U\-L\-L;
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{structconnection}{connection} $\ast$ \hyperlink{connections_8c_a5c8e2f611eeeca358faa588c318b0bcd}{connections\-\_\-get\-\_\-new\-\_\-connection} (\hyperlink{structserver}{server} $\ast$srv)
\item 
static int \hyperlink{connections_8c_af93cffa7bcfdb489c2197937c95b60f4}{connection\-\_\-del} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static int \hyperlink{connections_8c_a28619774d1a5305dc9b9ee7f51c66aff}{connection\-\_\-close} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static void \hyperlink{connections_8c_a8680aca93a9d3ceb44895afd1e65c46d}{connection\-\_\-read\-\_\-for\-\_\-eos} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static void \hyperlink{connections_8c_a3a72b5c804ce438249dee2c46cdeb1ee}{connection\-\_\-handle\-\_\-close\-\_\-state} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static void \hyperlink{connections_8c_a6c08ff87032a5293980d03ff8bcf72c8}{connection\-\_\-handle\-\_\-shutdown} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static void \hyperlink{connections_8c_ac2dd15ca5add76240251c6076a81cd18}{connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static void \hyperlink{connections_8c_a4ae28478bd5a7030cd1d4dfbebfd4eed}{connection\-\_\-handle\-\_\-errdoc\-\_\-init} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static int \hyperlink{connections_8c_a282c065079496d233b1229dc02b37bdf}{connection\-\_\-handle\-\_\-write\-\_\-prepare} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static int \hyperlink{connections_8c_a7c4882a35a1c2c1aca0767ba878fd577}{connection\-\_\-handle\-\_\-write} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
\hyperlink{structconnection}{connection} $\ast$ \hyperlink{connections_8c_a37bd032b3c4b092ec32937f7ecc83f4b}{connection\-\_\-init} (\hyperlink{structserver}{server} $\ast$srv)
\item 
void \hyperlink{connections_8c_a8421fc2ae87d6ff4d502019985ce8b12}{connections\-\_\-free} (\hyperlink{structserver}{server} $\ast$srv)
\item 
int \hyperlink{connections_8c_a22ff93513b16402d878728427b531310}{connection\-\_\-reset} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static int \hyperlink{connections_8c_aeed09240920a3eb42364719b8935916b}{connection\-\_\-handle\-\_\-read\-\_\-state} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static \hyperlink{settings_8h_a2a8ffc3e29980db202f39ab85ab7e98e}{handler\-\_\-t} \hyperlink{connections_8c_a04ac995dce804e3ec1ccc82c548f155b}{connection\-\_\-handle\-\_\-fdevent} (\hyperlink{structserver}{server} $\ast$srv, void $\ast$context, int revents)
\item 
\hyperlink{structconnection}{connection} $\ast$ \hyperlink{connections_8c_a9de42db6a21013453c6f69941950f7f6}{connection\-\_\-accept} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structserver__socket}{server\-\_\-socket} $\ast$srv\-\_\-socket)
\item 
\hyperlink{structconnection}{connection} $\ast$ \hyperlink{connections_8c_a6f4ecb9695bc4eec57b0ac17f303e53e}{connection\-\_\-accepted} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structserver__socket}{server\-\_\-socket} $\ast$srv\-\_\-socket, \hyperlink{unionsock__addr}{sock\-\_\-addr} $\ast$cnt\-\_\-addr, int cnt)
\item 
int \hyperlink{connections_8c_ab0a802eb02738ce1f4b93a9caeac9564}{connection\-\_\-state\-\_\-machine} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{connections_8c_a05b3586abd20197117285bc6f4e89394}{\index{connections.\-c@{connections.\-c}!C\-L\-E\-A\-N@{C\-L\-E\-A\-N}}
\index{C\-L\-E\-A\-N@{C\-L\-E\-A\-N}!connections.c@{connections.\-c}}
\subsubsection[{C\-L\-E\-A\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\-L\-E\-A\-N(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~con-\/$>$x = {\bf buffer\-\_\-init}();}}\label{connections_8c_a05b3586abd20197117285bc6f4e89394}


Referenced by connection\-\_\-init(), connection\-\_\-reset(), and connections\-\_\-free().

\hypertarget{connections_8c_a05b3586abd20197117285bc6f4e89394}{\index{connections.\-c@{connections.\-c}!C\-L\-E\-A\-N@{C\-L\-E\-A\-N}}
\index{C\-L\-E\-A\-N@{C\-L\-E\-A\-N}!connections.c@{connections.\-c}}
\subsubsection[{C\-L\-E\-A\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\-L\-E\-A\-N(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~{\bf buffer\-\_\-free}(con-\/$>$x);}}\label{connections_8c_a05b3586abd20197117285bc6f4e89394}
\hypertarget{connections_8c_a05b3586abd20197117285bc6f4e89394}{\index{connections.\-c@{connections.\-c}!C\-L\-E\-A\-N@{C\-L\-E\-A\-N}}
\index{C\-L\-E\-A\-N@{C\-L\-E\-A\-N}!connections.c@{connections.\-c}}
\subsubsection[{C\-L\-E\-A\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\-L\-E\-A\-N(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~if (con-\/$>$x) {\bf buffer\-\_\-reset}(con-\/$>$x);}}\label{connections_8c_a05b3586abd20197117285bc6f4e89394}
\hypertarget{connections_8c_a05b3586abd20197117285bc6f4e89394}{\index{connections.\-c@{connections.\-c}!C\-L\-E\-A\-N@{C\-L\-E\-A\-N}}
\index{C\-L\-E\-A\-N@{C\-L\-E\-A\-N}!connections.c@{connections.\-c}}
\subsubsection[{C\-L\-E\-A\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\-L\-E\-A\-N(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~if (con-\/$>$x) con-\/$>$x-\/$>$used = 0;}}\label{connections_8c_a05b3586abd20197117285bc6f4e89394}
\hypertarget{connections_8c_a05b3586abd20197117285bc6f4e89394}{\index{connections.\-c@{connections.\-c}!C\-L\-E\-A\-N@{C\-L\-E\-A\-N}}
\index{C\-L\-E\-A\-N@{C\-L\-E\-A\-N}!connections.c@{connections.\-c}}
\subsubsection[{C\-L\-E\-A\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\-L\-E\-A\-N(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~con-\/$>$request.\-x = N\-U\-L\-L;}}\label{connections_8c_a05b3586abd20197117285bc6f4e89394}


\subsection{Function Documentation}
\hypertarget{connections_8c_a9de42db6a21013453c6f69941950f7f6}{\index{connections.\-c@{connections.\-c}!connection\-\_\-accept@{connection\-\_\-accept}}
\index{connection\-\_\-accept@{connection\-\_\-accept}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-accept}]{\setlength{\rightskip}{0pt plus 5cm}{\bf connection}$\ast$ connection\-\_\-accept (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf server\-\_\-socket} $\ast$}]{srv\-\_\-socket}
\end{DoxyParamCaption}
)}}\label{connections_8c_a9de42db6a21013453c6f69941950f7f6}
check if we can still open a new connections

see \#1216

References connection\-\_\-accepted(), server\-::conns, server\-\_\-socket\-::fd, log\-\_\-error\-\_\-write(), server\-::max\-\_\-conns, network\-\_\-accept\-\_\-tcp\-\_\-nagle\-\_\-disable(), sock\-\_\-addr\-::plain, and connections\-::used.



Referenced by network\-\_\-server\-\_\-handle\-\_\-fdevent().

\hypertarget{connections_8c_a6f4ecb9695bc4eec57b0ac17f303e53e}{\index{connections.\-c@{connections.\-c}!connection\-\_\-accepted@{connection\-\_\-accepted}}
\index{connection\-\_\-accepted@{connection\-\_\-accepted}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-accepted}]{\setlength{\rightskip}{0pt plus 5cm}{\bf connection}$\ast$ connection\-\_\-accepted (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf server\-\_\-socket} $\ast$}]{srv\-\_\-socket, }
\item[{{\bf sock\-\_\-addr} $\ast$}]{cnt\-\_\-addr, }
\item[{int}]{cnt}
\end{DoxyParamCaption}
)}}\label{connections_8c_a6f4ecb9695bc4eec57b0ac17f303e53e}


References buffer\-\_\-copy\-\_\-string(), server\-::con\-\_\-opened, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-Q\-U\-E\-S\-T\-\_\-\-S\-T\-A\-R\-T, connection\-\_\-close(), connection\-\_\-handle\-\_\-fdevent(), connection\-\_\-set\-\_\-state(), connection\-::connection\-\_\-start, connections\-\_\-get\-\_\-new\-\_\-connection(), server\-::cur\-\_\-fds, server\-::cur\-\_\-ts, connection\-::dst\-\_\-addr, connection\-::dst\-\_\-addr\-\_\-buf, server\-::ev, connection\-::fd, connection\-::fde\-\_\-ndx, fdevent\-\_\-fcntl\-\_\-set\-\_\-nb\-\_\-cloexec\-\_\-sock(), fdevent\-\_\-register(), inet\-\_\-ntop\-\_\-cache\-\_\-get\-\_\-ip(), server\-\_\-socket\-::is\-\_\-ssl, log\-\_\-error\-\_\-write(), and connection\-::srv\-\_\-socket.



Referenced by connection\-\_\-accept(), and server\-\_\-oneshot\-\_\-init().

\hypertarget{connections_8c_a28619774d1a5305dc9b9ee7f51c66aff}{\index{connections.\-c@{connections.\-c}!connection\-\_\-close@{connection\-\_\-close}}
\index{connection\-\_\-close@{connection\-\_\-close}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-close}]{\setlength{\rightskip}{0pt plus 5cm}static int connection\-\_\-close (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a28619774d1a5305dc9b9ee7f51c66aff}


References C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-C\-O\-N\-N\-E\-C\-T, connection\-\_\-del(), connection\-\_\-set\-\_\-state(), server\-::cur\-\_\-fds, server\-::ev, connection\-::fd, connection\-::fde\-\_\-ndx, fdevent\-\_\-event\-\_\-del(), fdevent\-\_\-unregister(), server\-\_\-socket\-::is\-\_\-ssl, log\-\_\-error\-\_\-write(), server\-\_\-config\-::log\-\_\-state\-\_\-handling, connection\-::srv\-\_\-socket, and server\-::srvconf.



Referenced by connection\-\_\-accepted(), connection\-\_\-handle\-\_\-close\-\_\-state(), and connection\-\_\-handle\-\_\-shutdown().

\hypertarget{connections_8c_af93cffa7bcfdb489c2197937c95b60f4}{\index{connections.\-c@{connections.\-c}!connection\-\_\-del@{connection\-\_\-del}}
\index{connection\-\_\-del@{connection\-\_\-del}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-del}]{\setlength{\rightskip}{0pt plus 5cm}static int connection\-\_\-del (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_af93cffa7bcfdb489c2197937c95b60f4}


References request\-\_\-uri\-::authority, buffer\-\_\-reset(), server\-::conns, connection\-::fd, connection\-::ndx, request\-::orig\-\_\-uri, request\-\_\-uri\-::path, connections\-::ptr, request\-\_\-uri\-::query, connection\-::request, connection\-::uri, and connections\-::used.



Referenced by connection\-\_\-close().

\hypertarget{connections_8c_a3a72b5c804ce438249dee2c46cdeb1ee}{\index{connections.\-c@{connections.\-c}!connection\-\_\-handle\-\_\-close\-\_\-state@{connection\-\_\-handle\-\_\-close\-\_\-state}}
\index{connection\-\_\-handle\-\_\-close\-\_\-state@{connection\-\_\-handle\-\_\-close\-\_\-state}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-handle\-\_\-close\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}static void connection\-\_\-handle\-\_\-close\-\_\-state (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a3a72b5c804ce438249dee2c46cdeb1ee}


References connection\-::close\-\_\-timeout\-\_\-ts, connection\-\_\-close(), connection\-\_\-read\-\_\-for\-\_\-eos(), server\-::cur\-\_\-ts, and H\-T\-T\-P\-\_\-\-L\-I\-N\-G\-E\-R\-\_\-\-T\-I\-M\-E\-O\-U\-T.



Referenced by connection\-\_\-state\-\_\-machine().

\hypertarget{connections_8c_a4ae28478bd5a7030cd1d4dfbebfd4eed}{\index{connections.\-c@{connections.\-c}!connection\-\_\-handle\-\_\-errdoc\-\_\-init@{connection\-\_\-handle\-\_\-errdoc\-\_\-init}}
\index{connection\-\_\-handle\-\_\-errdoc\-\_\-init@{connection\-\_\-handle\-\_\-errdoc\-\_\-init}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-handle\-\_\-errdoc\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}static void connection\-\_\-handle\-\_\-errdoc\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a4ae28478bd5a7030cd1d4dfbebfd4eed}


References array\-\_\-get\-\_\-element(), array\-\_\-reset(), buffer\-\_\-free(), buffer\-\_\-init\-\_\-buffer(), buffer\-\_\-reset(), chunkqueue\-\_\-reset(), C\-O\-N\-S\-T\-\_\-\-B\-U\-F\-\_\-\-L\-E\-N, C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, response\-::headers, connection\-::http\-\_\-status, physical\-::path, connection\-::physical, connection\-::response, response\-\_\-header\-\_\-insert(), response\-::transfer\-\_\-encoding, data\-\_\-string\-::value, and connection\-::write\-\_\-queue.



Referenced by connection\-\_\-handle\-\_\-write\-\_\-prepare(), and connection\-\_\-state\-\_\-machine().

\hypertarget{connections_8c_a04ac995dce804e3ec1ccc82c548f155b}{\index{connections.\-c@{connections.\-c}!connection\-\_\-handle\-\_\-fdevent@{connection\-\_\-handle\-\_\-fdevent}}
\index{connection\-\_\-handle\-\_\-fdevent@{connection\-\_\-handle\-\_\-fdevent}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-handle\-\_\-fdevent}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf handler\-\_\-t} connection\-\_\-handle\-\_\-fdevent (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{void $\ast$}]{context, }
\item[{int}]{revents}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a04ac995dce804e3ec1ccc82c548f155b}


References chunkqueue\-\_\-is\-\_\-empty(), connection\-::close\-\_\-timeout\-\_\-ts, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-C\-L\-O\-S\-E, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-E\-R\-R\-O\-R, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-A\-D, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-W\-R\-I\-T\-E, connection\-\_\-handle\-\_\-read\-\_\-state(), connection\-\_\-handle\-\_\-write(), connection\-\_\-read\-\_\-for\-\_\-eos(), connection\-\_\-set\-\_\-state(), server\-::cur\-\_\-ts, connection\-::fd, F\-D\-E\-V\-E\-N\-T\-\_\-\-E\-R\-R, F\-D\-E\-V\-E\-N\-T\-\_\-\-H\-U\-P, F\-D\-E\-V\-E\-N\-T\-\_\-\-I\-N, fdevent\-\_\-is\-\_\-tcp\-\_\-half\-\_\-closed(), F\-D\-E\-V\-E\-N\-T\-\_\-\-O\-U\-T, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, H\-T\-T\-P\-\_\-\-L\-I\-N\-G\-E\-R\-\_\-\-T\-I\-M\-E\-O\-U\-T, connection\-::is\-\_\-readable, server\-\_\-socket\-::is\-\_\-ssl, connection\-::is\-\_\-writable, joblist\-\_\-append(), connection\-::keep\-\_\-alive, log\-\_\-error\-\_\-write(), connection\-::srv\-\_\-socket, connection\-::state, and connection\-::write\-\_\-queue.



Referenced by connection\-\_\-accepted().

\hypertarget{connections_8c_aeed09240920a3eb42364719b8935916b}{\index{connections.\-c@{connections.\-c}!connection\-\_\-handle\-\_\-read\-\_\-state@{connection\-\_\-handle\-\_\-read\-\_\-state}}
\index{connection\-\_\-handle\-\_\-read\-\_\-state@{connection\-\_\-handle\-\_\-read\-\_\-state}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-handle\-\_\-read\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}static int connection\-\_\-handle\-\_\-read\-\_\-state (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_aeed09240920a3eb42364719b8935916b}
handle all header and content read

we get called by the state-\/engine and by the fdevent-\/handler 

References buffer\-\_\-append\-\_\-string\-\_\-len(), buffer\-\_\-reset(), buffer\-\_\-string\-\_\-length(), chunkqueue\-::bytes\-\_\-out, chunkqueue\-\_\-is\-\_\-empty(), chunkqueue\-\_\-length(), chunkqueue\-\_\-remove\-\_\-finished\-\_\-chunks(), C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-E\-R\-R\-O\-R, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-H\-A\-N\-D\-L\-E\-\_\-\-R\-E\-Q\-U\-E\-S\-T, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-Q\-U\-E\-S\-T\-\_\-\-E\-N\-D, connection\-::conf, connection\-\_\-handle\-\_\-read(), connection\-\_\-set\-\_\-state(), server\-::cur\-\_\-ts, chunkqueue\-::first, specific\-\_\-config\-::high\-\_\-precision\-\_\-timestamps, connection\-::http\-\_\-status, connection\-::is\-\_\-readable, connection\-::keep\-\_\-alive, log\-\_\-clock\-\_\-gettime\-\_\-realtime(), log\-\_\-error\-\_\-write(), server\-\_\-config\-::max\-\_\-request\-\_\-field\-\_\-size, chunk\-::mem, chunk\-::next, chunk\-::offset, buffer\-::ptr, connection\-::read\-\_\-idle\-\_\-ts, connection\-::read\-\_\-queue, request\-::request, connection\-::request, connection\-::request\-\_\-count, connection\-::request\-\_\-start, connection\-::request\-\_\-start\-\_\-hp, and server\-::srvconf.



Referenced by connection\-\_\-handle\-\_\-fdevent(), and connection\-\_\-state\-\_\-machine().

\hypertarget{connections_8c_ac2dd15ca5add76240251c6076a81cd18}{\index{connections.\-c@{connections.\-c}!connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state@{connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state}}
\index{connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state@{connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}static void connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_ac2dd15ca5add76240251c6076a81cd18}


References chunkqueue\-::bytes\-\_\-in, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-E\-R\-R\-O\-R, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-Q\-U\-E\-S\-T\-\_\-\-S\-T\-A\-R\-T, server\-::con\-\_\-written, connection\-\_\-handle\-\_\-shutdown(), connection\-\_\-reset(), connection\-\_\-set\-\_\-state(), request\-::content\-\_\-length, server\-::cur\-\_\-ts, connection\-::http\-\_\-status, connection\-::keep\-\_\-alive, plugins\-\_\-call\-\_\-handle\-\_\-request\-\_\-done(), connection\-::read\-\_\-idle\-\_\-ts, connection\-::request, connection\-::request\-\_\-content\-\_\-queue, connection\-::request\-\_\-start, and connection\-::state.



Referenced by connection\-\_\-state\-\_\-machine().

\hypertarget{connections_8c_a6c08ff87032a5293980d03ff8bcf72c8}{\index{connections.\-c@{connections.\-c}!connection\-\_\-handle\-\_\-shutdown@{connection\-\_\-handle\-\_\-shutdown}}
\index{connection\-\_\-handle\-\_\-shutdown@{connection\-\_\-handle\-\_\-shutdown}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-handle\-\_\-shutdown}]{\setlength{\rightskip}{0pt plus 5cm}static void connection\-\_\-handle\-\_\-shutdown (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a6c08ff87032a5293980d03ff8bcf72c8}


References connection\-::close\-\_\-timeout\-\_\-ts, server\-::con\-\_\-closed, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-C\-L\-O\-S\-E, connection\-\_\-close(), connection\-\_\-reset(), connection\-\_\-set\-\_\-state(), server\-::cur\-\_\-ts, plugin\-::data, connection\-::fd, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, server\-\_\-socket\-::is\-\_\-ssl, log\-\_\-error\-\_\-write(), server\-\_\-config\-::log\-\_\-state\-\_\-handling, plugin\-::name, connection\-::plugin\-\_\-ctx, server\-::plugins, plugins\-\_\-call\-\_\-handle\-\_\-connection\-\_\-close(), buffer\-\_\-plugin\-::ptr, S\-H\-U\-T\-\_\-\-W\-R, connection\-::srv\-\_\-socket, server\-::srvconf, and buffer\-\_\-plugin\-::used.



Referenced by connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state().

\hypertarget{connections_8c_a7c4882a35a1c2c1aca0767ba878fd577}{\index{connections.\-c@{connections.\-c}!connection\-\_\-handle\-\_\-write@{connection\-\_\-handle\-\_\-write}}
\index{connection\-\_\-handle\-\_\-write@{connection\-\_\-handle\-\_\-write}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-handle\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}static int connection\-\_\-handle\-\_\-write (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a7c4882a35a1c2c1aca0767ba878fd577}


References C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-E\-R\-R\-O\-R, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-S\-P\-O\-N\-S\-E\-\_\-\-E\-N\-D, connection\-\_\-set\-\_\-state(), server\-::cur\-\_\-ts, connection\-::fd, connection\-::file\-\_\-finished, connection\-::is\-\_\-writable, log\-\_\-error\-\_\-write(), M\-A\-X\-\_\-\-W\-R\-I\-T\-E\-\_\-\-L\-I\-M\-I\-T, network\-\_\-write\-\_\-chunkqueue(), connection\-::write\-\_\-queue, and connection\-::write\-\_\-request\-\_\-ts.



Referenced by connection\-\_\-handle\-\_\-fdevent(), and connection\-\_\-state\-\_\-machine().

\hypertarget{connections_8c_a282c065079496d233b1229dc02b37bdf}{\index{connections.\-c@{connections.\-c}!connection\-\_\-handle\-\_\-write\-\_\-prepare@{connection\-\_\-handle\-\_\-write\-\_\-prepare}}
\index{connection\-\_\-handle\-\_\-write\-\_\-prepare@{connection\-\_\-handle\-\_\-write\-\_\-prepare}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-handle\-\_\-write\-\_\-prepare}]{\setlength{\rightskip}{0pt plus 5cm}static int connection\-\_\-handle\-\_\-write\-\_\-prepare (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a282c065079496d233b1229dc02b37bdf}
The Content-\/\-Length header only can be sent if we have content\-:
\begin{DoxyItemize}
\item H\-E\-A\-D doesn't have a content-\/body (but have a content-\/length)
\item 1xx, 204 and 304 don't have a content-\/body (R\-F\-C 2616 Section 4.\-3)
\end{DoxyItemize}

Otherwise generate a Content-\/\-Length header as chunked encoding is not available

the file isn't finished yet, but we have all headers

to get keep-\/alive we either need\-:
\begin{DoxyItemize}
\item Content-\/\-Length\-: ... (H\-T\-T\-P/1.\-0 and H\-T\-T\-P/1.\-0) or
\item Transfer-\/\-Encoding\-: chunked (H\-T\-T\-P/1.\-1)
\end{DoxyItemize}

if the backend sent a Connection\-: close, follow the wish

N\-O\-T\-E\-: if the backend sent Connection\-: Keep-\/\-Alive, but no Content-\/\-Length, we will close the connection. That's fine. We can always decide the close the connection

F\-I\-X\-M\-E\-: to be nice we should remove the Connection\-: ...

a H\-E\-A\-D request has the same as a G\-E\-T without the content

References array\-\_\-get\-\_\-element(), buffer\-\_\-append\-\_\-int(), buffer\-\_\-append\-\_\-string(), buffer\-\_\-append\-\_\-string\-\_\-len(), buffer\-\_\-append\-\_\-uint\-\_\-hex(), buffer\-\_\-copy\-\_\-buffer(), buffer\-\_\-copy\-\_\-int(), buffer\-\_\-copy\-\_\-string\-\_\-len(), buffer\-\_\-free(), buffer\-\_\-init(), buffer\-\_\-reset(), buffer\-\_\-string\-\_\-is\-\_\-empty(), buffer\-\_\-string\-\_\-set\-\_\-length(), chunkqueue\-\_\-append\-\_\-mem(), chunkqueue\-\_\-length(), chunkqueue\-\_\-prepend\-\_\-buffer(), chunkqueue\-\_\-reset(), connection\-::conf, connection\-\_\-handle\-\_\-errdoc\-\_\-init(), C\-O\-N\-S\-T\-\_\-\-B\-U\-F\-\_\-\-L\-E\-N, C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, stat\-\_\-cache\-\_\-entry\-::content\-\_\-type, D\-I\-R\-E\-C\-T, specific\-\_\-config\-::errorfile\-\_\-prefix, connection\-::file\-\_\-finished, get\-\_\-http\-\_\-status\-\_\-name(), H\-A\-N\-D\-L\-E\-R\-\_\-\-E\-R\-R\-O\-R, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, response\-::headers, http\-\_\-chunk\-\_\-append\-\_\-buffer(), http\-\_\-chunk\-\_\-append\-\_\-file(), H\-T\-T\-P\-\_\-\-C\-O\-N\-N\-E\-C\-T\-I\-O\-N, H\-T\-T\-P\-\_\-\-C\-O\-N\-T\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H, request\-::http\-\_\-method, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-G\-E\-T, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-H\-E\-A\-D, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-O\-P\-T\-I\-O\-N\-S, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-P\-O\-S\-T, http\-\_\-response\-\_\-write\-\_\-header(), connection\-::http\-\_\-status, request\-::http\-\_\-version, H\-T\-T\-P\-\_\-\-V\-E\-R\-S\-I\-O\-N\-\_\-1\-\_\-1, response\-::keep\-\_\-alive, connection\-::keep\-\_\-alive, log\-\_\-error\-\_\-write(), connection\-::mode, connection\-::parsed\-\_\-response, request\-\_\-uri\-::path, physical\-::path, connection\-::physical, plugins\-\_\-call\-\_\-handle\-\_\-response\-\_\-start(), buffer\-::ptr, connection\-::request, connection\-::response, response\-\_\-header\-\_\-insert(), response\-\_\-header\-\_\-overwrite(), stat\-\_\-cache\-\_\-get\-\_\-entry(), server\-::tmp\-\_\-buf, server\-::tmp\-\_\-chunk\-\_\-len, response\-::transfer\-\_\-encoding, connection\-::uri, data\-\_\-string\-::value, and connection\-::write\-\_\-queue.



Referenced by connection\-\_\-state\-\_\-machine().

\hypertarget{connections_8c_a37bd032b3c4b092ec32937f7ecc83f4b}{\index{connections.\-c@{connections.\-c}!connection\-\_\-init@{connection\-\_\-init}}
\index{connection\-\_\-init@{connection\-\_\-init}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf connection}$\ast$ connection\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv}
\end{DoxyParamCaption}
)}}\label{connections_8c_a37bd032b3c4b092ec32937f7ecc83f4b}


References array\-\_\-init(), physical\-::basedir, connection\-::bytes\-\_\-header, connection\-::bytes\-\_\-read, connection\-::bytes\-\_\-written, chunkqueue\-\_\-init(), C\-L\-E\-A\-N, connection\-::cond\-\_\-cache, server\-::config\-\_\-context, config\-\_\-setup\-\_\-connection(), physical\-::doc\-\_\-root, connection\-::environment, physical\-::etag, connection\-::fd, connection\-::fde\-\_\-ndx, force\-\_\-assert, request\-::headers, response\-::headers, connection\-::loops\-\_\-per\-\_\-request, connection\-::ndx, request\-::orig\-\_\-uri, physical\-::path, request\-::pathinfo, connection\-::plugin\-\_\-ctx, server\-::plugins, connection\-::read\-\_\-queue, physical\-::rel\-\_\-path, request\-::request, connection\-::request, connection\-::request\-\_\-content\-\_\-queue, request\-::request\-\_\-line, connection\-::response, U\-N\-U\-S\-E\-D, request\-::uri, array\-::used, buffer\-\_\-plugin\-::used, and connection\-::write\-\_\-queue.



Referenced by connections\-\_\-get\-\_\-new\-\_\-connection().

\hypertarget{connections_8c_a8680aca93a9d3ceb44895afd1e65c46d}{\index{connections.\-c@{connections.\-c}!connection\-\_\-read\-\_\-for\-\_\-eos@{connection\-\_\-read\-\_\-for\-\_\-eos}}
\index{connection\-\_\-read\-\_\-for\-\_\-eos@{connection\-\_\-read\-\_\-for\-\_\-eos}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-read\-\_\-for\-\_\-eos}]{\setlength{\rightskip}{0pt plus 5cm}static void connection\-\_\-read\-\_\-for\-\_\-eos (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a8680aca93a9d3ceb44895afd1e65c46d}


References connection\-::close\-\_\-timeout\-\_\-ts, server\-::cur\-\_\-ts, connection\-::fd, and H\-T\-T\-P\-\_\-\-L\-I\-N\-G\-E\-R\-\_\-\-T\-I\-M\-E\-O\-U\-T.



Referenced by connection\-\_\-handle\-\_\-close\-\_\-state(), and connection\-\_\-handle\-\_\-fdevent().

\hypertarget{connections_8c_a22ff93513b16402d878728427b531310}{\index{connections.\-c@{connections.\-c}!connection\-\_\-reset@{connection\-\_\-reset}}
\index{connection\-\_\-reset@{connection\-\_\-reset}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-reset}]{\setlength{\rightskip}{0pt plus 5cm}int connection\-\_\-reset (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)}}\label{connections_8c_a22ff93513b16402d878728427b531310}


References array\-\_\-reset(), connection\-::bytes\-\_\-header, connection\-::bytes\-\_\-read, connection\-::bytes\-\_\-written, connection\-::bytes\-\_\-written\-\_\-cur\-\_\-second, chunkqueue\-\_\-reset(), C\-L\-E\-A\-N, config\-\_\-setup\-\_\-connection(), connection\-\_\-response\-\_\-reset(), request\-::content\-\_\-length, connection\-::environment, connection\-::error\-\_\-handler\-\_\-saved\-\_\-status, connection\-::header\-\_\-len, request\-::headers, request\-::http\-\_\-if\-\_\-modified\-\_\-since, request\-::http\-\_\-if\-\_\-none\-\_\-match, request\-::http\-\_\-method, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-U\-N\-S\-E\-T, request\-::http\-\_\-version, H\-T\-T\-P\-\_\-\-V\-E\-R\-S\-I\-O\-N\-\_\-\-U\-N\-S\-E\-T, connection\-::is\-\_\-readable, connection\-::loops\-\_\-per\-\_\-request, request\-::pathinfo, plugins\-\_\-call\-\_\-connection\-\_\-reset(), request\-::request, connection\-::request, connection\-::request\-\_\-content\-\_\-queue, request\-::request\-\_\-line, request\-::te\-\_\-chunked, and request\-::uri.



Referenced by connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state(), connection\-\_\-handle\-\_\-shutdown(), connections\-\_\-free(), connections\-\_\-get\-\_\-new\-\_\-connection(), and plugins\-\_\-call\-\_\-init().

\hypertarget{connections_8c_ab0a802eb02738ce1f4b93a9caeac9564}{\index{connections.\-c@{connections.\-c}!connection\-\_\-state\-\_\-machine@{connection\-\_\-state\-\_\-machine}}
\index{connection\-\_\-state\-\_\-machine@{connection\-\_\-state\-\_\-machine}!connections.c@{connections.\-c}}
\subsubsection[{connection\-\_\-state\-\_\-machine}]{\setlength{\rightskip}{0pt plus 5cm}int connection\-\_\-state\-\_\-machine (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)}}\label{connections_8c_ab0a802eb02738ce1f4b93a9caeac9564}


References array\-\_\-get\-\_\-unused\-\_\-element(), array\-\_\-insert\-\_\-unique(), request\-\_\-uri\-::authority, buffer\-\_\-append\-\_\-int(), buffer\-\_\-copy\-\_\-buffer(), buffer\-\_\-copy\-\_\-string\-\_\-len(), buffer\-\_\-reset(), buffer\-\_\-string\-\_\-is\-\_\-empty(), chunkqueue\-::bytes\-\_\-in, chunkqueue\-\_\-is\-\_\-empty(), chunkqueue\-\_\-reset(), C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-C\-L\-O\-S\-E, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-C\-O\-N\-N\-E\-C\-T, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-E\-R\-R\-O\-R, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-H\-A\-N\-D\-L\-E\-\_\-\-R\-E\-Q\-U\-E\-S\-T, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-A\-D, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-A\-D\-\_\-\-P\-O\-S\-T, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-Q\-U\-E\-S\-T\-\_\-\-E\-N\-D, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-Q\-U\-E\-S\-T\-\_\-\-S\-T\-A\-R\-T, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-S\-P\-O\-N\-S\-E\-\_\-\-E\-N\-D, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-R\-E\-S\-P\-O\-N\-S\-E\-\_\-\-S\-T\-A\-R\-T, C\-O\-N\-\_\-\-S\-T\-A\-T\-E\-\_\-\-W\-R\-I\-T\-E, connection\-::conf, connection\-\_\-get\-\_\-state(), connection\-\_\-handle\-\_\-close\-\_\-state(), connection\-\_\-handle\-\_\-errdoc\-\_\-init(), connection\-\_\-handle\-\_\-read\-\_\-state(), connection\-\_\-handle\-\_\-response\-\_\-end\-\_\-state(), connection\-\_\-handle\-\_\-write(), connection\-\_\-handle\-\_\-write\-\_\-prepare(), connection\-\_\-set\-\_\-state(), C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, request\-::content\-\_\-length, response\-::content\-\_\-length, server\-::cur\-\_\-ts, data\-\_\-string\-\_\-init(), D\-I\-R\-E\-C\-T, connection\-::environment, specific\-\_\-config\-::error\-\_\-handler, specific\-\_\-config\-::error\-\_\-handler\-\_\-404, connection\-::error\-\_\-handler\-\_\-saved\-\_\-method, connection\-::error\-\_\-handler\-\_\-saved\-\_\-status, server\-::ev, connection\-::fd, connection\-::fde\-\_\-ndx, fdevent\-\_\-event\-\_\-get\-\_\-interest, fdevent\-\_\-event\-\_\-set(), F\-D\-E\-V\-E\-N\-T\-\_\-\-I\-N, F\-D\-E\-V\-E\-N\-T\-\_\-\-O\-U\-T, F\-D\-E\-V\-E\-N\-T\-\_\-\-S\-T\-R\-E\-A\-M\-\_\-\-R\-E\-Q\-U\-E\-S\-T\-\_\-\-P\-O\-L\-L\-I\-N, fdwaitqueue\-\_\-append(), connection\-::file\-\_\-finished, connection\-::file\-\_\-started, connection\-::got\-\_\-response, H\-A\-N\-D\-L\-E\-R\-\_\-\-C\-O\-M\-E\-B\-A\-C\-K, H\-A\-N\-D\-L\-E\-R\-\_\-\-E\-R\-R\-O\-R, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, H\-A\-N\-D\-L\-E\-R\-\_\-\-W\-A\-I\-T\-\_\-\-F\-O\-R\-\_\-\-E\-V\-E\-N\-T, H\-A\-N\-D\-L\-E\-R\-\_\-\-W\-A\-I\-T\-\_\-\-F\-O\-R\-\_\-\-F\-D, specific\-\_\-config\-::high\-\_\-precision\-\_\-timestamps, request\-::http\-\_\-method, H\-T\-T\-P\-\_\-\-M\-E\-T\-H\-O\-D\-\_\-\-G\-E\-T, http\-\_\-request\-\_\-parse(), http\-\_\-response\-\_\-prepare(), connection\-::http\-\_\-status, connection\-::is\-\_\-readable, connection\-::is\-\_\-writable, response\-::keep\-\_\-alive, connection\-::keep\-\_\-alive, log\-\_\-clock\-\_\-gettime\-\_\-realtime(), log\-\_\-error\-\_\-write(), server\-\_\-config\-::log\-\_\-state\-\_\-handling, connection\-::loops\-\_\-per\-\_\-request, connection\-::mode, request\-::orig\-\_\-uri, connection\-::parsed\-\_\-response, request\-\_\-uri\-::path, plugins\-\_\-call\-\_\-connection\-\_\-reset(), plugins\-\_\-call\-\_\-handle\-\_\-subrequest(), request\-\_\-uri\-::query, connection\-::read\-\_\-idle\-\_\-ts, connection\-::read\-\_\-queue, connection\-::request, connection\-::request\-\_\-content\-\_\-queue, connection\-::request\-\_\-count, connection\-::request\-\_\-start, connection\-::request\-\_\-start\-\_\-hp, connection\-::response, server\-::srvconf, connection\-::state, specific\-\_\-config\-::stream\-\_\-request\-\_\-body, specific\-\_\-config\-::stream\-\_\-response\-\_\-body, connection\-::traffic\-\_\-limit\-\_\-reached, response\-::transfer\-\_\-encoding, T\-Y\-P\-E\-\_\-\-S\-T\-R\-I\-N\-G, request\-::uri, connection\-::uri, data\-\_\-string\-::value, server\-::want\-\_\-fds, connection\-::write\-\_\-queue, and connection\-::write\-\_\-request\-\_\-ts.



Referenced by main(), network\-\_\-server\-\_\-handle\-\_\-fdevent(), and server\-\_\-oneshot\-\_\-init().

\hypertarget{connections_8c_a8421fc2ae87d6ff4d502019985ce8b12}{\index{connections.\-c@{connections.\-c}!connections\-\_\-free@{connections\-\_\-free}}
\index{connections\-\_\-free@{connections\-\_\-free}!connections.c@{connections.\-c}}
\subsubsection[{connections\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}void connections\-\_\-free (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv}
\end{DoxyParamCaption}
)}}\label{connections_8c_a8421fc2ae87d6ff4d502019985ce8b12}


References array\-\_\-free(), physical\-::basedir, chunkqueue\-\_\-free(), C\-L\-E\-A\-N, connection\-::cond\-\_\-cache, connection\-\_\-reset(), server\-::conns, physical\-::doc\-\_\-root, connection\-::environment, physical\-::etag, request\-::headers, response\-::headers, request\-::orig\-\_\-uri, physical\-::path, request\-::pathinfo, connection\-::plugin\-\_\-ctx, connections\-::ptr, connection\-::read\-\_\-queue, physical\-::rel\-\_\-path, request\-::request, connection\-::request, connection\-::request\-\_\-content\-\_\-queue, request\-::request\-\_\-line, connection\-::response, connections\-::size, request\-::uri, and connection\-::write\-\_\-queue.



Referenced by main().

\hypertarget{connections_8c_a5c8e2f611eeeca358faa588c318b0bcd}{\index{connections.\-c@{connections.\-c}!connections\-\_\-get\-\_\-new\-\_\-connection@{connections\-\_\-get\-\_\-new\-\_\-connection}}
\index{connections\-\_\-get\-\_\-new\-\_\-connection@{connections\-\_\-get\-\_\-new\-\_\-connection}!connections.c@{connections.\-c}}
\subsubsection[{connections\-\_\-get\-\_\-new\-\_\-connection}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf connection}$\ast$ connections\-\_\-get\-\_\-new\-\_\-connection (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{connections_8c_a5c8e2f611eeeca358faa588c318b0bcd}


References connection\-\_\-init(), connection\-\_\-reset(), server\-::conns, connection\-::fd, force\-\_\-assert, connection\-::ndx, connections\-::ptr, connections\-::size, and connections\-::used.



Referenced by connection\-\_\-accepted().

