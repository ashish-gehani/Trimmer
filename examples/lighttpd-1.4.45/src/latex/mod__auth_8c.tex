\hypertarget{mod__auth_8c}{\section{mod\-\_\-auth.\-c File Reference}
\label{mod__auth_8c}\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}}
}
{\ttfamily \#include \char`\"{}first.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}plugin.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}http\-\_\-auth.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}log.\-h\char`\"{}}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include \char`\"{}response.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}base64.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}md5.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rand.\-h\char`\"{}}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structplugin__config}{plugin\-\_\-config}
\item 
struct \hyperlink{structplugin__data}{plugin\-\_\-data}
\item 
struct \hyperlink{structdata__auth}{data\-\_\-auth}
\item 
struct \hyperlink{structdigest__kv}{digest\-\_\-kv}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{mod__auth_8c_a20876ec7c0c844d0e0c1628528bbb8da}{P\-A\-T\-C\-H}(x)~p-\/$>$conf.\-x = s-\/$>$x;
\item 
\#define \hyperlink{mod__auth_8c_a044f8d045fb7bf924ce44c1be20c6746}{H\-A\-S\-H\-L\-E\-N}~16
\item 
\#define \hyperlink{mod__auth_8c_a8a15023e03feb7b6ca9bedd0b8e3a737}{H\-A\-S\-H\-H\-E\-X\-L\-E\-N}~32
\item 
\#define \hyperlink{mod__auth_8c_ac4a3ed3432929804c708f7760fb79e28}{S}(x)~x, sizeof(x)-\/1, N\-U\-L\-L
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef unsigned char \hyperlink{mod__auth_8c_ac713e55c3ad120c7ae09a0249f1ef9e7}{H\-A\-S\-H} \mbox{[}\hyperlink{mod__secdownload_8c_a044f8d045fb7bf924ce44c1be20c6746}{H\-A\-S\-H\-L\-E\-N}\mbox{]}
\item 
typedef char \hyperlink{mod__auth_8c_ac7f94972a047c62b4661213eb0aec242}{H\-A\-S\-H\-H\-E\-X} \mbox{[}\hyperlink{mod__secdownload_8c_a8a15023e03feb7b6ca9bedd0b8e3a737}{H\-A\-S\-H\-H\-E\-X\-L\-E\-N}+1\mbox{]}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{settings_8h_a2a8ffc3e29980db202f39ab85ab7e98e}{handler\-\_\-t} \hyperlink{mod__auth_8c_a21d125bf751e31848445d7f32b997716}{mod\-\_\-auth\-\_\-check\-\_\-basic} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con, void $\ast$p\-\_\-d, const struct \hyperlink{structhttp__auth__require__t}{http\-\_\-auth\-\_\-require\-\_\-t} $\ast$require, const struct \hyperlink{structhttp__auth__backend__t}{http\-\_\-auth\-\_\-backend\-\_\-t} $\ast$backend)
\item 
static \hyperlink{settings_8h_a2a8ffc3e29980db202f39ab85ab7e98e}{handler\-\_\-t} \hyperlink{mod__auth_8c_aba52b6e7cd374ff95ff3901d8fa82aa3}{mod\-\_\-auth\-\_\-check\-\_\-digest} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con, void $\ast$p\-\_\-d, const struct \hyperlink{structhttp__auth__require__t}{http\-\_\-auth\-\_\-require\-\_\-t} $\ast$require, const struct \hyperlink{structhttp__auth__backend__t}{http\-\_\-auth\-\_\-backend\-\_\-t} $\ast$backend)
\item 
static \hyperlink{settings_8h_a2a8ffc3e29980db202f39ab85ab7e98e}{handler\-\_\-t} \hyperlink{mod__auth_8c_abfc13ae82d349caf344408692db73d7c}{mod\-\_\-auth\-\_\-check\-\_\-extern} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con, void $\ast$p\-\_\-d, const struct \hyperlink{structhttp__auth__require__t}{http\-\_\-auth\-\_\-require\-\_\-t} $\ast$require, const struct \hyperlink{structhttp__auth__backend__t}{http\-\_\-auth\-\_\-backend\-\_\-t} $\ast$backend)
\item 
\hyperlink{mod__auth_8c_a431fe1dfe21ad43606e47b18432858ad}{I\-N\-I\-T\-\_\-\-F\-U\-N\-C} (mod\-\_\-auth\-\_\-init)
\item 
\hyperlink{mod__auth_8c_ac17ba484be460fb0046d7812cc3a4fb3}{F\-R\-E\-E\-\_\-\-F\-U\-N\-C} (mod\-\_\-auth\-\_\-free)
\item 
static void \hyperlink{mod__auth_8c_a572e429fefb9d771b5f44091b1f92c52}{data\-\_\-auth\-\_\-free} (\hyperlink{structdata__unset}{data\-\_\-unset} $\ast$d)
\item 
static \hyperlink{structdata__auth}{data\-\_\-auth} $\ast$ \hyperlink{mod__auth_8c_ae04606ab200719f1f5550c12dd4cece0}{data\-\_\-auth\-\_\-init} (void)
\item 
static int \hyperlink{mod__auth_8c_a8c5d6aeaf4dec97ad1efde3e67b4b79d}{mod\-\_\-auth\-\_\-require\-\_\-parse} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structhttp__auth__require__t}{http\-\_\-auth\-\_\-require\-\_\-t} $\ast$const require, const \hyperlink{structbuffer}{buffer} $\ast$b)
\item 
\hyperlink{mod__auth_8c_a05d4133e72873451272e8219d10bc305}{S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C} (mod\-\_\-auth\-\_\-set\-\_\-defaults)
\item 
static int \hyperlink{mod__auth_8c_ac2caf01b8e17f5211946f3f302cf6704}{mod\-\_\-auth\-\_\-patch\-\_\-connection} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con, \hyperlink{structplugin__data}{plugin\-\_\-data} $\ast$p)
\item 
static \hyperlink{settings_8h_a2a8ffc3e29980db202f39ab85ab7e98e}{handler\-\_\-t} \hyperlink{mod__auth_8c_a17ca7a840d038c587c9b77fd09ae5016}{mod\-\_\-auth\-\_\-uri\-\_\-handler} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con, void $\ast$p\-\_\-d)
\item 
int \hyperlink{mod__auth_8c_a634368f6dfc5192d0ce3779637d1b439}{mod\-\_\-auth\-\_\-plugin\-\_\-init} (\hyperlink{structplugin}{plugin} $\ast$p)
\item 
static \hyperlink{settings_8h_a2a8ffc3e29980db202f39ab85ab7e98e}{handler\-\_\-t} \hyperlink{mod__auth_8c_ab77e501826dc13a1f8b9100f197c357b}{mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con)
\item 
static \hyperlink{settings_8h_a2a8ffc3e29980db202f39ab85ab7e98e}{handler\-\_\-t} \hyperlink{mod__auth_8c_af2dc00942348a45505fc79b1e48fb566}{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-basic} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con, \hyperlink{structbuffer}{buffer} $\ast$realm)
\item 
static void \hyperlink{mod__auth_8c_ae161bb34db1966fd8df1d5bbc0a0bf5d}{Cvt\-Hex} (const \hyperlink{mod__secdownload_8c_ac713e55c3ad120c7ae09a0249f1ef9e7}{H\-A\-S\-H} Bin, char($\ast$Hex)\mbox{[}33\mbox{]})
\item 
static \hyperlink{settings_8h_a2a8ffc3e29980db202f39ab85ab7e98e}{handler\-\_\-t} \hyperlink{mod__auth_8c_aeddfea91392e973c416e2b1537a6bf4d}{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest} (\hyperlink{structserver}{server} $\ast$srv, \hyperlink{structconnection}{connection} $\ast$con, \hyperlink{structbuffer}{buffer} $\ast$realm, int nonce\-\_\-stale)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{mod__auth_8c_a8a15023e03feb7b6ca9bedd0b8e3a737}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!H\-A\-S\-H\-H\-E\-X\-L\-E\-N@{H\-A\-S\-H\-H\-E\-X\-L\-E\-N}}
\index{H\-A\-S\-H\-H\-E\-X\-L\-E\-N@{H\-A\-S\-H\-H\-E\-X\-L\-E\-N}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{H\-A\-S\-H\-H\-E\-X\-L\-E\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define H\-A\-S\-H\-H\-E\-X\-L\-E\-N~32}}\label{mod__auth_8c_a8a15023e03feb7b6ca9bedd0b8e3a737}


Referenced by mod\-\_\-auth\-\_\-check\-\_\-digest().

\hypertarget{mod__auth_8c_a044f8d045fb7bf924ce44c1be20c6746}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!H\-A\-S\-H\-L\-E\-N@{H\-A\-S\-H\-L\-E\-N}}
\index{H\-A\-S\-H\-L\-E\-N@{H\-A\-S\-H\-L\-E\-N}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{H\-A\-S\-H\-L\-E\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define H\-A\-S\-H\-L\-E\-N~16}}\label{mod__auth_8c_a044f8d045fb7bf924ce44c1be20c6746}
\hypertarget{mod__auth_8c_a20876ec7c0c844d0e0c1628528bbb8da}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!P\-A\-T\-C\-H@{P\-A\-T\-C\-H}}
\index{P\-A\-T\-C\-H@{P\-A\-T\-C\-H}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{P\-A\-T\-C\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\-A\-T\-C\-H(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~p-\/$>$conf.\-x = s-\/$>$x;}}\label{mod__auth_8c_a20876ec7c0c844d0e0c1628528bbb8da}


Referenced by mod\-\_\-auth\-\_\-patch\-\_\-connection().

\hypertarget{mod__auth_8c_ac4a3ed3432929804c708f7760fb79e28}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!S@{S}}
\index{S@{S}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{S}]{\setlength{\rightskip}{0pt plus 5cm}\#define S(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~x, sizeof(x)-\/1, N\-U\-L\-L}}\label{mod__auth_8c_ac4a3ed3432929804c708f7760fb79e28}


Referenced by mod\-\_\-auth\-\_\-check\-\_\-digest().



\subsection{Typedef Documentation}
\hypertarget{mod__auth_8c_ac713e55c3ad120c7ae09a0249f1ef9e7}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!H\-A\-S\-H@{H\-A\-S\-H}}
\index{H\-A\-S\-H@{H\-A\-S\-H}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{H\-A\-S\-H}]{\setlength{\rightskip}{0pt plus 5cm}typedef unsigned char H\-A\-S\-H\mbox{[}{\bf H\-A\-S\-H\-L\-E\-N}\mbox{]}}}\label{mod__auth_8c_ac713e55c3ad120c7ae09a0249f1ef9e7}
\hypertarget{mod__auth_8c_ac7f94972a047c62b4661213eb0aec242}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!H\-A\-S\-H\-H\-E\-X@{H\-A\-S\-H\-H\-E\-X}}
\index{H\-A\-S\-H\-H\-E\-X@{H\-A\-S\-H\-H\-E\-X}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{H\-A\-S\-H\-H\-E\-X}]{\setlength{\rightskip}{0pt plus 5cm}typedef char H\-A\-S\-H\-H\-E\-X\mbox{[}{\bf H\-A\-S\-H\-H\-E\-X\-L\-E\-N}+1\mbox{]}}}\label{mod__auth_8c_ac7f94972a047c62b4661213eb0aec242}


\subsection{Function Documentation}
\hypertarget{mod__auth_8c_ae161bb34db1966fd8df1d5bbc0a0bf5d}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!Cvt\-Hex@{Cvt\-Hex}}
\index{Cvt\-Hex@{Cvt\-Hex}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{Cvt\-Hex}]{\setlength{\rightskip}{0pt plus 5cm}static void Cvt\-Hex (
\begin{DoxyParamCaption}
\item[{const {\bf H\-A\-S\-H}}]{Bin, }
\item[{char($\ast$)}]{Hex\mbox{[}33\mbox{]}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_ae161bb34db1966fd8df1d5bbc0a0bf5d}


References li\-\_\-tohex().



Referenced by mod\-\_\-auth\-\_\-check\-\_\-digest(), and mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest().

\hypertarget{mod__auth_8c_a572e429fefb9d771b5f44091b1f92c52}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!data\-\_\-auth\-\_\-free@{data\-\_\-auth\-\_\-free}}
\index{data\-\_\-auth\-\_\-free@{data\-\_\-auth\-\_\-free}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{data\-\_\-auth\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}static void data\-\_\-auth\-\_\-free (
\begin{DoxyParamCaption}
\item[{{\bf data\-\_\-unset} $\ast$}]{d}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_a572e429fefb9d771b5f44091b1f92c52}


References buffer\-\_\-free(), http\-\_\-auth\-\_\-require\-\_\-free(), and data\-\_\-auth\-::require.



Referenced by data\-\_\-auth\-\_\-init().

\hypertarget{mod__auth_8c_ae04606ab200719f1f5550c12dd4cece0}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!data\-\_\-auth\-\_\-init@{data\-\_\-auth\-\_\-init}}
\index{data\-\_\-auth\-\_\-init@{data\-\_\-auth\-\_\-init}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{data\-\_\-auth\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf data\-\_\-auth}$\ast$ data\-\_\-auth\-\_\-init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_ae04606ab200719f1f5550c12dd4cece0}


References buffer\-\_\-init(), data\-\_\-auth\-\_\-free(), force\-\_\-assert, http\-\_\-auth\-\_\-require\-\_\-init(), data\-\_\-auth\-::require, and T\-Y\-P\-E\-\_\-\-O\-T\-H\-E\-R.



Referenced by S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C().

\hypertarget{mod__auth_8c_ac17ba484be460fb0046d7812cc3a4fb3}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!F\-R\-E\-E\-\_\-\-F\-U\-N\-C@{F\-R\-E\-E\-\_\-\-F\-U\-N\-C}}
\index{F\-R\-E\-E\-\_\-\-F\-U\-N\-C@{F\-R\-E\-E\-\_\-\-F\-U\-N\-C}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{F\-R\-E\-E\-\_\-\-F\-U\-N\-C}]{\setlength{\rightskip}{0pt plus 5cm}F\-R\-E\-E\-\_\-\-F\-U\-N\-C (
\begin{DoxyParamCaption}
\item[{mod\-\_\-auth\-\_\-free}]{}
\end{DoxyParamCaption}
)}}\label{mod__auth_8c_ac17ba484be460fb0046d7812cc3a4fb3}


References array\-\_\-free(), plugin\-\_\-config\-::auth\-\_\-backend\-\_\-conf, plugin\-\_\-config\-::auth\-\_\-require, buffer\-\_\-free(), plugin\-\_\-data\-::config\-\_\-storage, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, and U\-N\-U\-S\-E\-D.

\hypertarget{mod__auth_8c_a431fe1dfe21ad43606e47b18432858ad}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!I\-N\-I\-T\-\_\-\-F\-U\-N\-C@{I\-N\-I\-T\-\_\-\-F\-U\-N\-C}}
\index{I\-N\-I\-T\-\_\-\-F\-U\-N\-C@{I\-N\-I\-T\-\_\-\-F\-U\-N\-C}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{I\-N\-I\-T\-\_\-\-F\-U\-N\-C}]{\setlength{\rightskip}{0pt plus 5cm}I\-N\-I\-T\-\_\-\-F\-U\-N\-C (
\begin{DoxyParamCaption}
\item[{mod\-\_\-auth\-\_\-init}]{}
\end{DoxyParamCaption}
)}}\label{mod__auth_8c_a431fe1dfe21ad43606e47b18432858ad}


References http\-\_\-auth\-\_\-scheme\-\_\-set(), mod\-\_\-auth\-\_\-check\-\_\-basic(), mod\-\_\-auth\-\_\-check\-\_\-digest(), and mod\-\_\-auth\-\_\-check\-\_\-extern().

\hypertarget{mod__auth_8c_a21d125bf751e31848445d7f32b997716}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-check\-\_\-basic@{mod\-\_\-auth\-\_\-check\-\_\-basic}}
\index{mod\-\_\-auth\-\_\-check\-\_\-basic@{mod\-\_\-auth\-\_\-check\-\_\-basic}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-check\-\_\-basic}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf handler\-\_\-t} mod\-\_\-auth\-\_\-check\-\_\-basic (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con, }
\item[{void $\ast$}]{p\-\_\-d, }
\item[{const struct {\bf http\-\_\-auth\-\_\-require\-\_\-t} $\ast$}]{require, }
\item[{const struct {\bf http\-\_\-auth\-\_\-backend\-\_\-t} $\ast$}]{backend}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_a21d125bf751e31848445d7f32b997716}


References array\-\_\-get\-\_\-element(), B\-A\-S\-E64\-\_\-\-S\-T\-A\-N\-D\-A\-R\-D, http\-\_\-auth\-\_\-backend\-\_\-t\-::basic, buffer\-\_\-append\-\_\-base64\-\_\-decode(), buffer\-\_\-free(), buffer\-\_\-init(), buffer\-\_\-is\-\_\-empty(), buffer\-\_\-string\-\_\-length(), buffer\-\_\-string\-\_\-set\-\_\-length(), C\-O\-N\-S\-T\-\_\-\-B\-U\-F\-\_\-\-L\-E\-N, C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, D\-I\-R\-E\-C\-T, connection\-::dst\-\_\-addr\-\_\-buf, connection\-::environment, H\-A\-N\-D\-L\-E\-R\-\_\-\-E\-R\-R\-O\-R, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, H\-A\-N\-D\-L\-E\-R\-\_\-\-U\-N\-S\-E\-T, H\-A\-N\-D\-L\-E\-R\-\_\-\-W\-A\-I\-T\-\_\-\-F\-O\-R\-\_\-\-E\-V\-E\-N\-T, request\-::headers, http\-\_\-auth\-\_\-setenv(), connection\-::http\-\_\-status, log\-\_\-error\-\_\-write(), mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request(), mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-basic(), connection\-::mode, http\-\_\-auth\-\_\-backend\-\_\-t\-::p\-\_\-d, request\-\_\-uri\-::path, buffer\-::ptr, http\-\_\-auth\-\_\-require\-\_\-t\-::realm, connection\-::request, U\-N\-U\-S\-E\-D, connection\-::uri, and data\-\_\-string\-::value.



Referenced by I\-N\-I\-T\-\_\-\-F\-U\-N\-C().

\hypertarget{mod__auth_8c_aba52b6e7cd374ff95ff3901d8fa82aa3}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-check\-\_\-digest@{mod\-\_\-auth\-\_\-check\-\_\-digest}}
\index{mod\-\_\-auth\-\_\-check\-\_\-digest@{mod\-\_\-auth\-\_\-check\-\_\-digest}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-check\-\_\-digest}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf handler\-\_\-t} mod\-\_\-auth\-\_\-check\-\_\-digest (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con, }
\item[{void $\ast$}]{p\-\_\-d, }
\item[{const struct {\bf http\-\_\-auth\-\_\-require\-\_\-t} $\ast$}]{require, }
\item[{const struct {\bf http\-\_\-auth\-\_\-backend\-\_\-t} $\ast$}]{backend}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_aba52b6e7cd374ff95ff3901d8fa82aa3}
protect the md5-\/sess against missing cnonce and nonce

References array\-\_\-get\-\_\-element(), buffer\-\_\-copy\-\_\-string\-\_\-len(), buffer\-\_\-free(), buffer\-\_\-init(), buffer\-\_\-is\-\_\-empty(), buffer\-\_\-is\-\_\-equal\-\_\-string(), buffer\-\_\-string\-\_\-length(), C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, server\-::cur\-\_\-ts, Cvt\-Hex(), http\-\_\-auth\-\_\-backend\-\_\-t\-::digest, D\-I\-R\-E\-C\-T, connection\-::dst\-\_\-addr\-\_\-buf, connection\-::environment, force\-\_\-assert, get\-\_\-http\-\_\-method\-\_\-name(), H\-A\-N\-D\-L\-E\-R\-\_\-\-E\-R\-R\-O\-R, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, H\-A\-N\-D\-L\-E\-R\-\_\-\-W\-A\-I\-T\-\_\-\-F\-O\-R\-\_\-\-E\-V\-E\-N\-T, H\-A\-S\-H\-H\-E\-X\-L\-E\-N, request\-::headers, hex2int(), http\-\_\-auth\-\_\-match\-\_\-rules(), http\-\_\-auth\-\_\-setenv(), request\-::http\-\_\-method, connection\-::http\-\_\-status, digest\-\_\-kv\-::key, li\-\_\-\-M\-D5\-\_\-\-Final(), li\-\_\-\-M\-D5\-\_\-\-Init(), li\-\_\-\-M\-D5\-\_\-\-Update(), light\-\_\-isxdigit(), log\-\_\-error\-\_\-write(), mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request(), mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest(), connection\-::mode, request\-::orig\-\_\-uri, http\-\_\-auth\-\_\-backend\-\_\-t\-::p\-\_\-d, request\-\_\-uri\-::path, buffer\-::ptr, digest\-\_\-kv\-::ptr, http\-\_\-auth\-\_\-require\-\_\-t\-::realm, connection\-::request, S, U\-N\-U\-S\-E\-D, connection\-::uri, and data\-\_\-string\-::value.



Referenced by I\-N\-I\-T\-\_\-\-F\-U\-N\-C().

\hypertarget{mod__auth_8c_abfc13ae82d349caf344408692db73d7c}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-check\-\_\-extern@{mod\-\_\-auth\-\_\-check\-\_\-extern}}
\index{mod\-\_\-auth\-\_\-check\-\_\-extern@{mod\-\_\-auth\-\_\-check\-\_\-extern}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-check\-\_\-extern}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf handler\-\_\-t} mod\-\_\-auth\-\_\-check\-\_\-extern (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con, }
\item[{void $\ast$}]{p\-\_\-d, }
\item[{const struct {\bf http\-\_\-auth\-\_\-require\-\_\-t} $\ast$}]{require, }
\item[{const struct {\bf http\-\_\-auth\-\_\-backend\-\_\-t} $\ast$}]{backend}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_abfc13ae82d349caf344408692db73d7c}


References array\-\_\-get\-\_\-element(), D\-I\-R\-E\-C\-T, connection\-::environment, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, http\-\_\-auth\-\_\-match\-\_\-rules(), connection\-::http\-\_\-status, connection\-::mode, buffer\-::ptr, U\-N\-U\-S\-E\-D, and data\-\_\-string\-::value.



Referenced by I\-N\-I\-T\-\_\-\-F\-U\-N\-C().

\hypertarget{mod__auth_8c_ac2caf01b8e17f5211946f3f302cf6704}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-patch\-\_\-connection@{mod\-\_\-auth\-\_\-patch\-\_\-connection}}
\index{mod\-\_\-auth\-\_\-patch\-\_\-connection@{mod\-\_\-auth\-\_\-patch\-\_\-connection}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-patch\-\_\-connection}]{\setlength{\rightskip}{0pt plus 5cm}static int mod\-\_\-auth\-\_\-patch\-\_\-connection (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con, }
\item[{{\bf plugin\-\_\-data} $\ast$}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_ac2caf01b8e17f5211946f3f302cf6704}


References buffer\-\_\-is\-\_\-equal\-\_\-string(), config\-\_\-check\-\_\-cond(), server\-::config\-\_\-context, plugin\-\_\-data\-::config\-\_\-storage, C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, array\-::data, P\-A\-T\-C\-H, array\-::used, and data\-\_\-config\-::value.



Referenced by mod\-\_\-auth\-\_\-uri\-\_\-handler().

\hypertarget{mod__auth_8c_a634368f6dfc5192d0ce3779637d1b439}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-plugin\-\_\-init@{mod\-\_\-auth\-\_\-plugin\-\_\-init}}
\index{mod\-\_\-auth\-\_\-plugin\-\_\-init@{mod\-\_\-auth\-\_\-plugin\-\_\-init}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-plugin\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int mod\-\_\-auth\-\_\-plugin\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf plugin} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{mod__auth_8c_a634368f6dfc5192d0ce3779637d1b439}


References buffer\-\_\-init\-\_\-string(), plugin\-::cleanup, plugin\-::data, plugin\-::handle\-\_\-uri\-\_\-clean, plugin\-::init, mod\-\_\-auth\-\_\-uri\-\_\-handler(), plugin\-::name, plugin\-::set\-\_\-defaults, and plugin\-::version.

\hypertarget{mod__auth_8c_a8c5d6aeaf4dec97ad1efde3e67b4b79d}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-require\-\_\-parse@{mod\-\_\-auth\-\_\-require\-\_\-parse}}
\index{mod\-\_\-auth\-\_\-require\-\_\-parse@{mod\-\_\-auth\-\_\-require\-\_\-parse}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-require\-\_\-parse}]{\setlength{\rightskip}{0pt plus 5cm}static int mod\-\_\-auth\-\_\-require\-\_\-parse (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf http\-\_\-auth\-\_\-require\-\_\-t} $\ast$const}]{require, }
\item[{const {\bf buffer} $\ast$}]{b}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_a8c5d6aeaf4dec97ad1efde3e67b4b79d}


References array\-\_\-insert\-\_\-unique(), buffer\-\_\-copy\-\_\-string\-\_\-len(), buffer\-\_\-is\-\_\-equal\-\_\-string(), C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, data\-\_\-string\-\_\-init(), http\-\_\-auth\-\_\-require\-\_\-t\-::group, http\-\_\-auth\-\_\-require\-\_\-t\-::host, log\-\_\-error\-\_\-write(), buffer\-::ptr, http\-\_\-auth\-\_\-require\-\_\-t\-::user, and http\-\_\-auth\-\_\-require\-\_\-t\-::valid\-\_\-user.



Referenced by S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C().

\hypertarget{mod__auth_8c_ab77e501826dc13a1f8b9100f197c357b}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request@{mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request}}
\index{mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request@{mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf handler\-\_\-t} mod\-\_\-auth\-\_\-send\-\_\-400\-\_\-bad\-\_\-request (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_ab77e501826dc13a1f8b9100f197c357b}


References D\-I\-R\-E\-C\-T, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, connection\-::http\-\_\-status, connection\-::mode, and U\-N\-U\-S\-E\-D.



Referenced by mod\-\_\-auth\-\_\-check\-\_\-basic(), and mod\-\_\-auth\-\_\-check\-\_\-digest().

\hypertarget{mod__auth_8c_af2dc00942348a45505fc79b1e48fb566}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-basic@{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-basic}}
\index{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-basic@{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-basic}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-basic}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf handler\-\_\-t} mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-basic (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con, }
\item[{{\bf buffer} $\ast$}]{realm}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_af2dc00942348a45505fc79b1e48fb566}


References buffer\-\_\-append\-\_\-string\-\_\-buffer(), buffer\-\_\-append\-\_\-string\-\_\-len(), buffer\-\_\-copy\-\_\-string\-\_\-len(), C\-O\-N\-S\-T\-\_\-\-B\-U\-F\-\_\-\-L\-E\-N, C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, D\-I\-R\-E\-C\-T, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, connection\-::http\-\_\-status, connection\-::mode, response\-\_\-header\-\_\-insert(), and server\-::tmp\-\_\-buf.



Referenced by mod\-\_\-auth\-\_\-check\-\_\-basic().

\hypertarget{mod__auth_8c_aeddfea91392e973c416e2b1537a6bf4d}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest@{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest}}
\index{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest@{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf handler\-\_\-t} mod\-\_\-auth\-\_\-send\-\_\-401\-\_\-unauthorized\-\_\-digest (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con, }
\item[{{\bf buffer} $\ast$}]{realm, }
\item[{int}]{nonce\-\_\-stale}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_aeddfea91392e973c416e2b1537a6bf4d}


References buffer\-\_\-append\-\_\-string(), buffer\-\_\-append\-\_\-string\-\_\-buffer(), buffer\-\_\-append\-\_\-string\-\_\-len(), buffer\-\_\-append\-\_\-uint\-\_\-hex(), buffer\-\_\-copy\-\_\-string\-\_\-len(), C\-O\-N\-S\-T\-\_\-\-B\-U\-F\-\_\-\-L\-E\-N, C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, server\-::cur\-\_\-ts, Cvt\-Hex(), D\-I\-R\-E\-C\-T, force\-\_\-assert, H\-A\-N\-D\-L\-E\-R\-\_\-\-F\-I\-N\-I\-S\-H\-E\-D, connection\-::http\-\_\-status, L\-I\-\_\-\-I\-T\-O\-S\-T\-R\-I\-N\-G\-\_\-\-L\-E\-N\-G\-T\-H, li\-\_\-itostrn(), li\-\_\-\-M\-D5\-\_\-\-Final(), li\-\_\-\-M\-D5\-\_\-\-Init(), li\-\_\-\-M\-D5\-\_\-\-Update(), li\-\_\-rand\-\_\-pseudo\-\_\-bytes(), connection\-::mode, response\-\_\-header\-\_\-insert(), and server\-::tmp\-\_\-buf.



Referenced by mod\-\_\-auth\-\_\-check\-\_\-digest().

\hypertarget{mod__auth_8c_a17ca7a840d038c587c9b77fd09ae5016}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!mod\-\_\-auth\-\_\-uri\-\_\-handler@{mod\-\_\-auth\-\_\-uri\-\_\-handler}}
\index{mod\-\_\-auth\-\_\-uri\-\_\-handler@{mod\-\_\-auth\-\_\-uri\-\_\-handler}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{mod\-\_\-auth\-\_\-uri\-\_\-handler}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf handler\-\_\-t} mod\-\_\-auth\-\_\-uri\-\_\-handler (
\begin{DoxyParamCaption}
\item[{{\bf server} $\ast$}]{srv, }
\item[{{\bf connection} $\ast$}]{con, }
\item[{void $\ast$}]{p\-\_\-d}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mod__auth_8c_a17ca7a840d038c587c9b77fd09ae5016}


References plugin\-\_\-config\-::auth\-\_\-backend, plugin\-\_\-config\-::auth\-\_\-require, buffer\-\_\-string\-\_\-length(), http\-\_\-auth\-\_\-scheme\-\_\-t\-::checkfn, plugin\-\_\-data\-::conf, connection\-::conf, array\-::data, specific\-\_\-config\-::force\-\_\-lowercase\-\_\-filenames, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, mod\-\_\-auth\-\_\-patch\-\_\-connection(), http\-\_\-auth\-\_\-scheme\-\_\-t\-::p\-\_\-d, request\-\_\-uri\-::path, buffer\-::ptr, data\-\_\-auth\-::require, http\-\_\-auth\-\_\-require\-\_\-t\-::scheme, connection\-::uri, and array\-::used.



Referenced by mod\-\_\-auth\-\_\-plugin\-\_\-init().

\hypertarget{mod__auth_8c_a05d4133e72873451272e8219d10bc305}{\index{mod\-\_\-auth.\-c@{mod\-\_\-auth.\-c}!S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C@{S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C}}
\index{S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C@{S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C}!mod_auth.c@{mod\-\_\-auth.\-c}}
\subsubsection[{S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C}]{\setlength{\rightskip}{0pt plus 5cm}S\-E\-T\-D\-E\-F\-A\-U\-L\-T\-S\-\_\-\-F\-U\-N\-C (
\begin{DoxyParamCaption}
\item[{mod\-\_\-auth\-\_\-set\-\_\-defaults}]{}
\end{DoxyParamCaption}
)}}\label{mod__auth_8c_a05d4133e72873451272e8219d10bc305}


References array\-\_\-get\-\_\-element(), array\-\_\-init(), array\-\_\-insert\-\_\-unique(), buffer\-\_\-copy\-\_\-buffer(), buffer\-\_\-init(), buffer\-\_\-is\-\_\-empty(), buffer\-\_\-is\-\_\-equal\-\_\-string(), buffer\-\_\-string\-\_\-is\-\_\-empty(), config\-\_\-insert\-\_\-values\-\_\-global(), plugin\-\_\-data\-::config\-\_\-storage, C\-O\-N\-S\-T\-\_\-\-S\-T\-R\-\_\-\-L\-E\-N, array\-::data, data\-\_\-auth\-\_\-init(), config\-\_\-values\-\_\-t\-::destination, H\-A\-N\-D\-L\-E\-R\-\_\-\-E\-R\-R\-O\-R, H\-A\-N\-D\-L\-E\-R\-\_\-\-G\-O\-\_\-\-O\-N, http\-\_\-auth\-\_\-backend\-\_\-get(), http\-\_\-auth\-\_\-scheme\-\_\-get(), log\-\_\-error\-\_\-write(), mod\-\_\-auth\-\_\-require\-\_\-parse(), http\-\_\-auth\-\_\-require\-\_\-t\-::realm, data\-\_\-auth\-::require, http\-\_\-auth\-\_\-require\-\_\-t\-::scheme, T\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-L\-O\-C\-A\-L, T\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-S\-C\-O\-P\-E\-\_\-\-C\-O\-N\-N\-E\-C\-T\-I\-O\-N, T\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-S\-C\-O\-P\-E\-\_\-\-S\-E\-R\-V\-E\-R, T\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-S\-C\-O\-P\-E\-\_\-\-U\-N\-S\-E\-T, T\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-S\-T\-R\-I\-N\-G, T\-\_\-\-C\-O\-N\-F\-I\-G\-\_\-\-U\-N\-S\-E\-T, T\-Y\-P\-E\-\_\-\-A\-R\-R\-A\-Y, T\-Y\-P\-E\-\_\-\-S\-T\-R\-I\-N\-G, array\-::used, data\-\_\-string\-::value, data\-\_\-array\-::value, and data\-\_\-config\-::value.

